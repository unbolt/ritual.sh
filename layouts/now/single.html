{{ define "main" }}
<div class="server-room">
  <!-- Page title sign -->
  <div class="server-room-sign">
    <div class="sign-frame">
      <div class="sign-content">
        <div class="sign-title">/NOW</div>
        <div class="sign-subtitle">Updated {{ now.Format "02/01/2006" }}</div>
      </div>
    </div>
  </div>

  <div class="server-room-container">
    <!-- Server Rack 1: Production Infrastructure -->
    <!-- prettier-ignore -->
    {{ partial "elements/server-rack.html"
    (dict "height" "650px" "title" "PROD-RACK-01"
    "units" (slice
      (dict "type" "switch" "label" "Core-SW-01" "ports" 24)
      (dict "type" "spacer")
      (dict "type" "server" "label" "WEB-01" "led1" "green" "led2" "green" "drives" 1)
      (dict "type" "server" "label" "WEB-02" "led1" "green" "led2" "amber" "drives" 1)
      (dict "type" "server" "label" "DB-01" "led1" "green" "led2" "green" "drives" 2)
      (dict "type" "spacer")
      (dict "type" "patch-panel" "ports" 24)
      (dict "type" "blank")
      (dict "type" "server" "label" "API-01" "led1" "green" "led2" "blue" "drives" 1)
      (dict "type" "server" "label" "Cache-01" "led1" "green" "led2" "green" "drives" 1)
    ) ) }}

    <!-- Whiteboard: Currently -->
    {{ partial "elements/whiteboard.html" (dict "file" "currently.md" "context"
    .) }}

    <!-- Server Rack 2: Storage & Backup -->
    <!-- prettier-ignore -->
    {{ partial "elements/server-rack.html" 
    (dict "height" "650px" "title" "STORAGE-01" 
    "units" (slice 
      (dict "type" "server" "label" "NAS-01" "led1" "green" "led2" "green" "drives" 1 "size" 1) 
      (dict "type" "spacer") 
      (dict "type" "storage" "label" "SAN-Primary" "drives" 20 "size" 3)
      (dict "type" "spacer")
      (dict "type" "server" "label" "BACKUP-01" "led1" "blue" "led2" "amber" "drives" 1)
      (dict "type" "blank")
    ) ) }}

    <!-- Terminal Desk -->
    <div class="terminal-desk">
      <div class="terminal-monitor">
        <div class="terminal-screen">
          <div style="color: #0f0; text-shadow: 0 0 5px #0f0">
            <p>$ neofetch</p>
            <p><strong>NERV</strong></p>
            <p>---</p>
            <p><strong>CPU</strong>: AMD Ryzen 7 9800X3D @ 5.46 Ghz</p>
            <p><strong>GPU</strong>: AMD Radeon RX 7900 XTX</p>
            <p><strong>RAM</strong>: 64 GiB @ 6000 MT/S</p>
            <br />
            <p><strong>OS</strong>: Bazzite</p>
            <br />
            <p><strong>Usage</strong>: Main gaming and development machine</p>
            <p><span class="cursor-blink">_</span></p>
          </div>
        </div>
      </div>
      <div class="desk-surface"></div>
      <div
        class="ambient-light green"
        style="bottom: 100px; left: 0; width: 400px; height: 320px; z-index: -1"
      ></div>
    </div>

    <!-- prettier-ignore -->
    {{ partial "elements/whiteboard.html" (dict "file" "media.md" "context" .) }}

    <!-- Server Rack 3: Dev & Testing -->
    <!-- prettier-ignore -->
    {{ partial "elements/server-rack.html" 
    (dict "height" "700px" "title" "DEV-RACK-01" 
    "units" (slice 
      (dict "type" "switch" "label" "Dev-SW-01" "ports" 24) 
      (dict "type" "patch-panel" "label" "Patch-Dev" "ports" 24) 
      (dict "type" "spacer") 
      (dict "type" "server" "label" "Dev-01" "led1" "green" "led2" "amber" "drives" 2)
      (dict "type" "server" "label" "Dev-02" "led1" "blue" "led2" "green" "drives" 2)
      (dict "type" "server" "label" "Test-01" "led1" "green" "led2" "red" "drives" 1)
      (dict "type" "spacer") 
      (dict "type" "server" "label" "CI/CD" "led1" "green" "led2" "green" "drives" 2)
      (dict "type" "blank") 
      (dict "type" "server" "label" "Monitoring" "led1" "blue" "led2" "amber" "drives" 1)
    )) }}

    <!-- Whiteboard: Learning Queue -->
    {{ partial "elements/whiteboard.html" (dict "file" "learning-queue.md"
    "context" .) }}

    <!-- Server Rack 4: Power & Network -->
    <!-- prettier-ignore -->
    {{ partial "elements/server-rack.html" 
      (dict "height" "550px" "title" "INFRA-01" "units" (slice 
        (dict "type" "ups" "label" "UPS-Primary" "capacity" "98" "size" 2) 
        (dict "type" "spacer") 
        (dict "type" "switch" "label" "Edge-SW-01" "ports" 24) 
        (dict "type" "server" "label" "Firewall" "led1" "green" "led2" "green" "drives" 1) 
        (dict "type" "server" "label" "DHCP" "led1" "green" "led2" "blue" "drives" 1) 
        (dict "type" "blank")
        (dict "type" "blank") 
      ) ) }}

    <!-- Whiteboard: Homelab Architecture -->
    {{ partial "elements/whiteboard.html" (dict "file" "homelab.md" "context" .)
    }}

    <!-- Monitor: System Metrics -->
    {{ partial "elements/monitor-screen.html" (dict "width" "400px" "height"
    "350px" "type" "metrics" "title" "WEB-01 - METRICS" "color" "green" ) }}

    <!-- Monitor: Live Graph -->
    {{ partial "elements/monitor-screen.html" (dict "width" "450px" "height"
    "380px" "type" "graph" "title" "NETWORK TRAFFIC" "color" "blue" ) }}

    <!-- Monitor: System Logs -->
    {{ partial "elements/monitor-screen.html" (dict "width" "420px" "height"
    "400px" "type" "logs" "title" "SYSTEM LOGS" "color" "green" ) }}

    <!-- Monitor: Network Stats -->
    {{ partial "elements/monitor-screen.html" (dict "width" "380px" "height"
    "380px" "type" "network" "title" "BANDWIDTH MONITOR" "color" "amber" ) }}

    <!-- Monitor: Terminal -->
    {{ partial "elements/monitor-screen.html" (dict "width" "400px" "height"
    "320px" "type" "terminal" "title" "db-primary.local" "color" "green" ) }}
  </div>
</div>

<script>
  // Enable horizontal scrolling with mouse wheel
  const serverRoom = document.querySelector(".server-room");

  if (serverRoom) {
    serverRoom.addEventListener(
      "wheel",
      (e) => {
        // Check if there's horizontal scrollable content
        if (serverRoom.scrollWidth > serverRoom.clientWidth) {
          e.preventDefault();
          serverRoom.scrollLeft += e.deltaY;
        }
      },
      { passive: false },
    );
  }
</script>
{{ end }}
